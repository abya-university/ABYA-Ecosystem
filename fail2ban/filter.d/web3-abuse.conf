# Fail2ban filter for Web3 application abuse
# Detects suspicious patterns in ABYA Ecosystem logs

[Definition]
# Detect rapid wallet connection attempts
failregex = ^<HOST> .* "POST /api/wallet/connect" .* 429 .*$
            ^<HOST> .* "POST /api/auth/signin" .* 429 .*$
            ^<HOST> .* "POST /api/ipfs/upload" .* 429 .*$
            ^<HOST> .* "GET /api/contracts/.*" .* 429 .*$
            ^<HOST> .* "POST /api/transactions/.*" .* 429 .*$

# Detect suspicious user agents
            ^<HOST> .* "(curl|wget|python|bot|crawler|scanner)" .* 40[0-9] .*$

# Detect directory traversal attempts
            ^<HOST> .* "\.\./.*" .* 40[0-9] .*$
            ^<HOST> .* "\.\.\\.*" .* 40[0-9] .*$

# Detect SQL injection attempts
            ^<HOST> .* "(union|select|insert|delete|update|drop|create|alter)" .* 40[0-9] .*$

# Detect XSS attempts
            ^<HOST> .* "(<script|javascript:|vbscript:|onload=|onerror=)" .* 40[0-9] .*$

# Detect file inclusion attempts
            ^<HOST> .* "(php://|file://|data://)" .* 40[0-9] .*$

ignoreregex =

[Init]
datepattern = ^%%d/%%b/%%Y:%%H:%%M:%%S %%z